<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bar Chart</title>
<script type="text/javascript"
	src="https://www.gstatic.com/charts/loader.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!-- 이게 있어야 ajax가 실행 된다  -->
<script>
	google.charts.load('current', {
		packages : [ 'corechart', 'bar' ]
	});
	google.charts.setOnLoadCallback(drawMultSeries);
	function drawMultSeries() {
		$.ajax({
			url : "/eis/getBar"
		}).done(
				function(data) {
					//json에 데이터 넣기
					var result = data.result;
					var columns = data.columns;
					var size = data.size;

					//google chart 이용하여 데이터 넣기
					var chartData = new google.visualization.DataTable();

					//column에 데이터 넣기
					for (var i = 0; i < columns.length; i++) {
						chartData.addColumn(columns[i].type, columns[i].value);
					}
					
					// chart 데이터 설정 _> 동적으로 데이터를 받을 수 있게 변경 , column을 추가하려면 HomeController만 수정하면 된다
					$.each(result, function(index, value) {
						var data =[]
						
						for (var i=0; i<columns.length; i++) {
							data[i] =  value[columns[i].column];
						}
						
						chartData.addRows([ data ]);
						
					}); //.each

					var options = {
						title : 'Population of Largest U.S. Cities', /* 차트의 타이틀  */
						chartArea : {width : '50%' }, /* 화면에 시각화된 차트의 가로 크기  */
						hAxis : { /* 축선 여기선 가로 */
							title : 'Total Population',
							minValue : 0	// 시작포인트가 0이다. 즉 차트의 시작 포인트를 나타냄  
						
						},
						vAxis : { // 축선  여기서는 세로. 각각 데이터 행을 나타낸다.
							title : 'City'
						}
					};
					
					// 차트 생성하기
					var chart = new google.visualization.BarChart(document.getElementById("chart_div"));  /* visualization 뒤에 부분(BarChart)을 바꿔주면 차트 모양이 바뀐다.   */
					chart.draw(chartData, options);


				});//.done
				

	}
</script>
</head>
<body>
	<div id="chart_div"></div>

</body>
</html>
